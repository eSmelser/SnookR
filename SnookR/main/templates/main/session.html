<!-- 
     Copyright &copy; 2017 Evan Smelser
      This software is Licensed under the MIT license. For more info please see SnookR/COPYING
-->
{% extends 'main/base.html' %}
{% load static %}

{# snooker_extras uses the get_unregister_url tag #}
{% load snooker_extras %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'main/css/session.css' %}">
{% endblock %}

{% block title %}Subs{% endblock %}
{% block content %}
    <div class="container">
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div id="calendar"></div>

            {% if current_user_sub %}
                <h2>You Are Available for {{ session|title }}</h2>
                <div class="post-content">
                    <div class="panel panel-default panel-info">
                        <div class="panel-body">
                            <div class="pull-left">
                                <a href="{{ current_user_sub.user.get_absolute_url }}">
                                    <img class="img-circle" width="50px" height="50px"
                                         style="margin-right:8px; margin-top:-5px;"
                                            {% if current_user_sub.user.profile.thumbnail %}
                                         src="{{ current_user_sub.user.profile.thumbnail.url }}"
                                            {% else %}
                                         src="{% static 'main/images/default_profile.jpg' %}"
                                            {% endif %}
                                    >
                                </a>
                            </div>

                            <div>
                                <h4 class="pull-left"><a href="#"
                                                         style="text-decoration:none;"><strong>{{ current_user_sub.user }}</strong></a>
                                </h4>
                                <form class="pull-right session-button"
                                      action="{% get_unregister_url session current_user_sub %}">
                                    <input type="submit" value="Unregister">
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
            {% else %}
                <form action="{{ session.get_register_url }}">
                    <input class="btn btn-primary" type="submit" value="Sign up for {{ session|title }}'s sub list!">
                </form>
            {% endif %}


            <h2>Subs Available for {{ session|title }}</h2>
            {#  This layout is inspired by the snippet found her: https://bootsnipp.com/snippets/56ExR #}
            <div id='sub-list' class="post-content">
                {% for sub in subs %}
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div class="pull-left">
                                <a href="{{ sub.user.get_absolute_url }}">
                                    <img class="img-circle" width="50px" height="50px"
                                         style="margin-right:8px; margin-top:-5px;"
                                            {% if sub.user.profile.thumbnail %}
                                         src="{{ sub.user.profile.thumbnail.url }}"
                                            {% else %}
                                         src="{% static 'main/images/default_profile.jpg' %}"
                                            {% endif %}
                                    >
                                </a>
                            </div>
                            <h4 class="pull-left"><a href="#"
                                                     style="text-decoration:none;"><strong>{{ sub.user }}</strong></a>
                            </h4>

                            <button class="session-button pull-right" type="button" href="{{ sub.invite_url }}">Invite
                            </button>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="col-md-2"></div>
        </div>
    </div>
{% endblock %}
{% block footer_scripts %}
    <script type="text/javascript">
        let DIVISION_SLUG = "{{ session.division.slug|escapejs|safe }}";
        let SESSION_SLUG = "{{ session.slug|escapejs|safe }}";
        let SESSION_NAME = "{{  session.name|escapejs|safe }}";
    </script>

    <link href="{% static 'scheduler/js/fullcalendar-3.7.0/fullcalendar.css' %}" rel='stylesheet'/>
    <link href="{% static 'scheduler/js/fullcalendar-3.7.0/fullcalendar.print.css' %}" rel='stylesheet' media='print'/>
    <script src="{% static 'scheduler/js/fullcalendar-3.7.0/lib/jquery.min.js' %}"></script>
    <script src="{% static 'scheduler/js/fullcalendar-3.7.0/lib/jquery-ui.min.js' %}"></script>
    <script src="{% static 'scheduler/js/fullcalendar-3.7.0/lib/moment.min.js' %}"></script>
    <script src="{% static 'scheduler/js/fullcalendar-3.7.0/fullcalendar.js' %}"></script>
    <script src="{% static 'api/js/api.js' %}"></script>
    <script src="{% static 'scheduler/js/session-calendar.js' %}"></script>
{% endblock %}